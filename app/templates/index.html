<!DOCTYPE html>
<html>
<head>
    <title> Elasticsearch Dashboard </title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/dashboard.css')}}">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
</head>

<body ng-app="esApp">
    <h2> Elasticsearch Sinature Dashboard</h2>
    <div ng-controller="selectCtrl">
	    Get {{total}} document from index {{ search_index }}
	    <h4>Select sinature display</h4>
	    <ul>
		{% for sig in signatures  %}
		<li>
		<span> {{ sig }}</span> 
		    <select name="{{ sig }}" ng-model="selectSignature" ng-change="alert_ch()"> 
				<option selected value="no">NO</option>
				<option value="yes">YES</option>
		    </select>
		</li>
		{% endfor %}
	    </ul>
	    <table>
		<tr>
		    <th>STT</th>
		    <th>INDEX</th>
		    <th>TIMESTAMP</th>
		    <th>SIGNATURE</th>
		    <th>ENABLE WARNING</th>
		</tr>
		{% set i = 1 %}
		{% for hit in all_hits %}	
		
		<tr class="doc_row">
		    <td>{{i}}</td>
		    <td>{{ search_index }}</td>
		    <td>{{ hit['_source']['timestamp'] }}</td>
		    <td class="sinature">{{ hit['_source']['alert']['signature'] }}</td>
		    <td>
			<select>
			    <option value="yes">yes</option>
			    <option value="no">no</option>
			</select>
		    </td>
		</tr>
		{% set i= i+1%}
		{% endfor %}
	    </table>
	</div>
	<script type="text/javascript">
		angular.module('esApp', [])
		.controller('selectCtrl',['$scope', '$window','$document', function($scope, $window, $document){
			$scope.alert_ch = function(){
			   //all_rows = $document.find('.doc_row'); 
			    all_rows = angular.element(document).find('tr.doc_row');
			   console.log(all_rows.length);
			};
		}]);
	</script>
</body>
</html>
